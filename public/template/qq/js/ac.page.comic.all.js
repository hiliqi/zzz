AC.namespace("AC.Page.ComicAll");
AC.Page.ComicAll={init:function(){AC.Page.Core.init();this.setSelectorHighlight("mark",mark);this.setSelectorHighlight("audience",audience);this.setSelectorHighlight("finish",finish);this.setSelectorHighlight("vip",vip);this.setSelectorHighlight("copyright",copyright);if(state!=""){var list=state.split(",");$.each(list,function(i,val){AC.Page.ComicAll.setSelectorHighlight("state",val)})}else this.setSelectorHighlight("state","");if(nation!=""){var list=nation.split(",");$.each(list,function(i,val){AC.Page.ComicAll.setSelectorHighlight("nation",
val)})}else this.setSelectorHighlight("nation","");if(theme!=""){var list=theme.split(",");var open=false;$.each(list,function(i,val){val=parseInt(val);if(val>13)open=true;else;});this.setTagsHtml("",open);$.each(list,function(i,val){AC.Page.ComicAll.setSelectorHighlight("theme",val)})}else{this.setTagsHtml("",false);this.setSelectorHighlight("theme","")}if(type!=""){var list=type.split(",");$.each(list,function(i,val){AC.Page.ComicAll.setSelectorHighlight("type",val)})}else this.setSelectorHighlight("type",
"");this.getSelect();this.bindEvent();this.search()},getSelect:function(){var param=[];var ids=[];if(vip=="1"||vip=="2"){tagName=$("#vip_"+vip).attr("title");param.push(tagName);ids.push("vip_"+vip)}if(finish=="1"||finish=="2"){tagName=$("#finish_"+finish).attr("title");param.push(tagName);ids.push("finish_"+finish)}if(theme!=""){var list=theme.split(",");$.each(list,function(i,val){if(parseInt(val)>=1&&parseInt(val)<=40){tagName=$("#theme_"+val).attr("title");param.push(tagName);ids.push("theme_"+
val)}})}if(audience>="1"&&audience<="4"){tagName=$("#audience_"+audience).attr("title");param.push(tagName);ids.push("audience_"+audience)}if(state!=""){var list=state.split(",");$.each(list,function(i,val){tagName=$("#state_"+val).attr("title");param.push(tagName);ids.push("state_"+val)})}if(type!=""){var list=type.split(",");$.each(list,function(i,val){tagName=$("#type_"+val).attr("title");param.push(tagName);ids.push("type_"+val)})}if(nation!=""){var list=nation.split(",");$.each(list,function(i,
val){tagName=$("#nation_"+val).attr("title");param.push(tagName);ids.push("nation_"+val)})}if(copyright!=""){tagName=$("#copyright_"+copyright).attr("title");param.push(tagName);ids.push("copyright_"+copyright)}if(mark!=""){tagName=$("#mark_"+mark).attr("title");param.push(tagName);ids.push("mark_"+mark)}$.each(param,function(i,val){$(".ret-check-ft").parent().append("<a href='javascript:void(0)' class='ret-btn-item' ref='"+ids[i]+"' title='\u70b9\u51fb\u5173\u95ed'>"+val+"</a>")})},bindEvent:function(){$(".single a").live("click",
function(){$(this).prevAll("a").removeClass("active");$(this).nextAll("a").removeClass("active");$(this).toggleClass("active");AC.Page.ComicAll.reloadList()});$(".multi a").live("click",function(){c=$(this).attr("class");if(c=="single"){$(this).prevAll("a").removeClass("active");$(this).nextAll("a").removeClass("active")}else{$(this).prevAll(".single").removeClass("active");$(this).nextAll(".single").removeClass("active")}$(this).toggleClass("active");AC.Page.ComicAll.reloadList()});$(".ret-btn-item").live("click",
function(){$(this).hide();id=$(this).attr("ref");$("#"+id).removeClass("active");AC.Page.ComicAll.reloadList()})},setTagsHtml:function(theme,isOpen){if(tagList){tagsArr=new Array;var listArr=tagList.split("|");for(i=0;i<listArr.length;i++)tagsArr.push(listArr[i].split("#"));var num=isOpen===true?tagsArr.length:13;var html='<a href="javascript:void(0)" class="single" title="\u5168\u90e8">\u5168\u90e8</a>';for(i=0;i<num;i++)html+='<a href="javascript:void(0)" title="'+tagsArr[i][1]+'" id="theme_'+tagsArr[i][0]+
'">'+tagsArr[i][1]+"</a>";html+=isOpen===true?'<span class="ret-tags-close" title="\u5173\u95ed">\u5173\u95ed</span>':'<span class="ret-tags-open" title="\u5c55\u5f00">\u5c55\u5f00</span>';$("#p_theme").html(html)}},setSelectorHighlight:function(id,value){if(value=="")$("#p_"+id+" a:first").addClass("active");else $("#p_"+id+" a[id='"+id+"_"+value+"']").addClass("active")},reloadList:function(){var markId=$("#p_mark").find(".active").attr("id");var audienceId=$("#p_audience").find(".active").attr("id");
var finishId=$("#p_finish").find(".active").attr("id");var search=$("#search-condition").find(".active").attr("id");var vipState=$("#p_vip").find(".active").attr("id");var copyright=$("#p_copyright").find(".active").attr("id");themeId=this.getMultiId("theme");stateId=this.getMultiId("state");nationId=this.getMultiId("nation");typeId=this.getMultiId("type");var mark=markId==undefined?"":markId.replace("mark_","");var audience=audienceId==undefined?"":audienceId.replace("audience_","");var theme=themeId==
undefined?"":themeId.replace("theme_","");var type=typeId==undefined?"":typeId.replace("type_","");var finish=finishId==undefined?"":finishId.replace("finish_","");var state=stateId==undefined?"":stateId.replace("state_","");var nation=nationId==undefined?"":nationId.replace("nation_","");var vip=vipState==undefined?"":vipState.replace("vip_","");var copyright=copyright==undefined?"":copyright.replace("copyright_","");var param=[];if(mark!=""){param.push("mark");param.push(mark)}if(audience!=""){param.push("audience");
param.push(audience)}if(theme!=""){param.push("theme");param.push(theme)}if(type!=""){param.push("type");param.push(type)}if(finish!=""){param.push("finish");param.push(finish)}if(state!=""){param.push("state");param.push(state)}if(nation!=""){param.push("nation");param.push(nation)}if(search!=""){param.push("search");param.push(search)}if(vip!=""){param.push("vip");param.push(vip)}if(copyright!=""){param.push("copyright");param.push(copyright)}param.push("page");param.push(1);location.replace("/Comic/all/"+
param.join("/"))},getMultiId:function(div_id){list=new Array;$("#p_"+div_id).find(".active").each(function(i){var item=$(this).attr("id");if(item!=undefined)list[i]=item.replace(div_id+"_","")});return list.join("-")},search:function(){var self=this;$(".ret-tags-open").live("click",function(){self.setTagsHtml(theme,true);var list=theme.split(",");$.each(list,function(i,val){AC.Page.ComicAll.setSelectorHighlight("theme",val)})});$(".ret-tags-close").live("click",function(){self.setTagsHtml(theme,false);
var list=theme.split(",");$.each(list,function(i,val){AC.Page.ComicAll.setSelectorHighlight("theme",val)})});$("#search-condition").delegate("li","click",function(){$(this).addClass("active").siblings().removeClass("active");AC.Page.ComicAll.reloadList()});if(search=="time")$("#search-condition li").removeClass("active").eq(0).addClass("active");else if(search=="hot")$("#search-condition li").removeClass("active").eq(1).addClass("active");else if(search=="week")$("#search-condition li").removeClass("active").eq(0).addClass("active");
else if(search=="month")$("#search-condition li").removeClass("active").eq(1).addClass("active")}};
